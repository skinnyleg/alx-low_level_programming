more nested loops and more functions
